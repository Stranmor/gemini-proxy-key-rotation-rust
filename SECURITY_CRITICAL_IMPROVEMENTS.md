# –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —É–ª—É—á—à–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏

## üîí –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

### 1. –£—Å–∏–ª–µ–Ω–Ω–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏

**–ü—Ä–æ–±–ª–µ–º–∞**: –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –±—ã–ª–∞ —É—è–∑–≤–∏–º–∞ –¥–ª—è –∞—Ç–∞–∫ –±—Ä—É—Ç—Ñ–æ—Ä—Å–∞ –∏ —Ä–∞–±–æ—Ç–∞–ª–∞ –ø–æ HTTP.

**–†–µ—à–µ–Ω–∏–µ**:
- **Rate limiting**: –ú–∞–∫—Å–∏–º—É–º 5 –ø–æ–ø—ã—Ç–æ–∫ –≤—Ö–æ–¥–∞ –∑–∞ 5 –º–∏–Ω—É—Ç
- **IP-–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞**: –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –Ω–∞ 1 —á–∞—Å –ø–æ—Å–ª–µ –ø—Ä–µ–≤—ã—à–µ–Ω–∏—è –ª–∏–º–∏—Ç–∞
- **HTTPS enforcement**: –¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ HTTPS –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ
- **Session management**: –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Ä–æ—Ç–∞—Ü–∏–µ–π

**–§–∞–π–ª—ã**:
- `src/security/mod.rs` - –æ—Å–Ω–æ–≤–Ω–æ–π –º–æ–¥—É–ª—å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- `src/security/token_manager.rs` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞–º–∏

### 2. –ü—Ä–æ–∞–∫—Ç–∏–≤–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∑–¥–æ—Ä–æ–≤—å—è –∫–ª—é—á–µ–π

**–ü—Ä–æ–±–ª–µ–º–∞**: –ö–ª—é—á–∏ –ø—Ä–æ–≤–µ—Ä—è–ª–∏—Å—å —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏, –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª–∞ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞.

**–†–µ—à–µ–Ω–∏–µ**:
- **Health scoring**: –°–∏—Å—Ç–µ–º–∞ –æ—Ü–µ–Ω–∫–∏ –∑–¥–æ—Ä–æ–≤—å—è –∫–ª—é—á–µ–π (0.0-1.0)
- **Proactive monitoring**: –§–æ–Ω–æ–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
- **Recovery attempts**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø–æ–ø—ã—Ç–∫–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è
- **Detailed analytics**: –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∫–∞–∂–¥–æ–º—É –∫–ª—é—á—É

**–§–∞–π–ª—ã**:
- `src/monitoring/key_health.rs` - –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∑–¥–æ—Ä–æ–≤—å—è –∫–ª—é—á–µ–π
- `src/monitoring/mod.rs` - —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

### 3. –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

**–ü—Ä–æ–±–ª–µ–º–∞**: –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç –æ—à–∏–±–æ–∫, —Å–ª–æ–∂–Ω–æ—Å—Ç—å –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏.

**–†–µ—à–µ–Ω–∏–µ**:
- **Security violations**: –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –æ—à–∏–±–∫–∏ –¥–ª—è –Ω–∞—Ä—É—à–µ–Ω–∏–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- **Rate limit errors**: –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–æ–≤
- **Health check errors**: –û—à–∏–±–∫–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∑–¥–æ—Ä–æ–≤—å—è –∫–ª—é—á–µ–π
- **Structured logging**: –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º

## üöÄ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

```yaml
# config.yaml
server:
  admin_token: "your-secure-token-here"
  security:
    require_https: true
    max_login_attempts: 5
    lockout_duration_secs: 3600
    session_timeout_secs: 86400
```

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ –∫–æ–¥

```rust
// –í main.rs –∏–ª–∏ state.rs
use crate::monitoring::MonitoringSystem;
use crate::security::SecurityMiddleware;

// –°–æ–∑–¥–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
let monitoring = MonitoringSystem::new(key_manager.clone());
monitoring.start().await?;

// –î–æ–±–∞–≤–ª–µ–Ω–∏–µ middleware –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
let security = SecurityMiddleware::new();
let app = Router::new()
    .route("/admin/*path", get(admin_handler))
    .layer(middleware::from_fn_with_state(
        security.clone(),
        |state, req, next| security.admin_protection(state, req, next)
    ));
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∞–ª–µ—Ä—Ç—ã

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –∞–ª–µ—Ä—Ç—ã

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –ø—Ä–∏:
- –ë–æ–ª–µ–µ 3 –Ω–µ–∑–¥–æ—Ä–æ–≤—ã—Ö –∫–ª—é—á–µ–π
- –£—Ä–æ–≤–Ω–µ –æ—à–∏–±–æ–∫ –≤—ã—à–µ 10%
- –í—Ä–µ–º–µ–Ω–∏ –æ—Ç–≤–µ—Ç–∞ –≤—ã—à–µ 5 —Å–µ–∫—É–Ω–¥

### –ú–µ—Ç—Ä–∏–∫–∏ –∑–¥–æ—Ä–æ–≤—å—è –∫–ª—é—á–µ–π

```rust
// –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
let stats = monitoring.get_system_stats().await;
println!("Healthy keys: {}/{}", stats.healthy_keys, stats.total_keys);
println!("Error rate: {:.2}%", stats.error_rate * 100.0);

// –ü–æ–ª—É—á–µ–Ω–∏–µ –Ω–µ–∑–¥–æ—Ä–æ–≤—ã—Ö –∫–ª—é—á–µ–π
let unhealthy = monitoring.key_health().get_unhealthy_keys(5).await;
for key in unhealthy {
    println!("Key {}: score {:.2}", key.key_preview, key.health_score);
}
```

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ü–æ—Ä–æ–≥–∏ –∞–ª–µ—Ä—Ç–æ–≤

```rust
let thresholds = AlertThresholds {
    unhealthy_keys_threshold: 3,
    error_rate_threshold: 0.1, // 10%
    response_time_threshold: Duration::from_secs(5),
};
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

```rust
let security = SecurityMiddleware::new()
    .with_max_attempts(5)
    .with_lockout_duration(Duration::from_secs(3600))
    .with_https_required(true);
```

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- ‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç –±—Ä—É—Ç—Ñ–æ—Ä—Å–∞ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏
- ‚úÖ –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ HTTPS
- ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Å—Å–∏—è–º–∏ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Ä–æ—Ç–∞—Ü–∏–µ–π
- ‚úÖ –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å
- ‚úÖ –ü—Ä–æ–∞–∫—Ç–∏–≤–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∑–¥–æ—Ä–æ–≤—å—è –∫–ª—é—á–µ–π
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø–æ–ø—ã—Ç–∫–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è
- ‚úÖ –°–∏—Å—Ç–µ–º–∞ –∞–ª–µ—Ä—Ç–æ–≤ –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Å–∏—Ç—É–∞—Ü–∏–π
- ‚úÖ –î–µ—Ç–∞–ª—å–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ù–∞–±–ª—é–¥–∞–µ–º–æ—Å—Ç—å
- ‚úÖ Health score –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª—é—á–∞
- ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —É—Å–ø–µ—à–Ω–æ—Å—Ç–∏ –∑–∞–ø—Ä–æ—Å–æ–≤
- ‚úÖ –í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –ø—Ä–æ–±–ª–µ–º–∞—Ö

## üîÑ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Prometheus** –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞ –º–µ—Ç—Ä–∏–∫
2. **Webhook notifications** –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∞–ª–µ—Ä—Ç–æ–≤
3. **Dashboard** –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
4. **Automated recovery** –¥–ª—è –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∫–ª—é—á–µ–π

–≠—Ç–∏ —É–ª—É—á—à–µ–Ω–∏—è –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –ø–æ–≤—ã—à–∞—é—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã, –¥–µ–ª–∞—è –µ—ë –≥–æ—Ç–æ–≤–æ–π –¥–ª—è production –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è.